# Data

## Description

## Research Plan
We can go into more detail about how each of these factors helps to answer the study questions about educational fairness and geographical differences in US public schools given the dataset columns that are provided:

1. *Geographical Information:*
   - *Location Address, City, State, ZIP Code, Latitude, and Longitude:* It is possible to identify schools in urban, suburban, or rural locations thanks to the extensive geographic information about each school that is provided in these columns. The distribution of schools across the nation can be mapped and visualised through the use of latitude and longitude in spatial analysis.
   - *County Name:* This variable enables more investigation of the geographic setting, taking into account features at the county level that could affect educational results.

2. *Educational Equity:*
   - *Total of Free Lunch and Reduced-Price Lunch Eligible, Free Lunch Program, Reduced-Lunch Program:* These columns shed light on pupils' socioeconomic circumstances. Examining these characteristics can assist in determining the student population's economic background, which is important information for comprehending educational equity.
   - *Title I Eligible, School-wide Title I:* These columns provide information about a school's eligibility for Title I financing, which is frequently linked to educational institutions that serve kids from low-income backgrounds.
   - *Total Students, All Grades:* One key indicator of the overall size of the institution is the total number of students. It is used as the denominator in the computation of several ratios, such as the student-teacher ratio.
   - *Total Teachers, Student-Teacher Ratio:* Details about each school's instructional materials are provided in these columns. In order to ensure educational equity, it is essential to assess the sufficiency of teacher resources, which can be done by analysing these variables.

3. *Racial Disparities:*
   - *Columns for Students of Different Racial Backgrounds (e.g., AM, AS, BL, HP, HI, TR, WH):* A breakdown of student enrollment by gender and race is shown in these columns. It is possible to investigate racial differences in enrollment, performance, and resource access through the analysis of these variables.

4. *School Characteristics:*
   - *Whether a Charter School, Magnet School Indicator, Virtual School Status:* The sort of school is described in these columns. Understanding how various school types contribute to patterns connected to equity and geography can be gained through the analysis of these factors.
   - *School Level:* This variable provides information about whether disparities and equity issues fluctuate at different educational levels by classifying schools into elementary, middle, and high schools.
   - *Locale Code:* This code categorises the school's location, specifying whether it is in a town, city, suburb, or rural area. Investigating the potential effects of the local environment on educational outcomes requires this information.

These factors can be combined and analysed to answer the research questions given in the introduction. Finding trends, relationships, and disparities pertaining to geography, race, and educational equity can be accomplished through the use of statistical modelling, spatial analysis, and data visualisation approaches. A thorough investigation of the intricacies of the US public education system can be supported by the dataset's rich information on student demographics, school features, and geographic location.

## Missing value analysis

```{r r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
library(openintro)
library(dplyr)
library(tidyr)
library(tibble)
library(ggplot2)
library(choroplethr)
library(scales)
```

```{r}
data = read.csv("Data/Public_School_Characteristics_2020-21.csv")

missing_state <- data %>% 
    group_by(LSTATE) %>% 
    summarise(sum_na = round(mean(is.na(TOTAL)),4)*100)

missing_state <- missing_state %>% 
                  transmute(region = tolower(usdata::abbr2state(LSTATE)), 
                            value = sum_na)

state_choropleth(missing_state %>% drop_na(),
                 title = "Percentage of missing values for total students by State",
                 legend = "Percentage")
```

```{r}
data1 = data %>% drop_na(TOTAL)

data1 <- data1 %>% select(23,34:50)

missing_counts <- data1 %>%
  group_by(SCHOOL_LEVEL) %>%
  summarize(across(-starts_with("SCHOOL"), ~mean(is.na(.))*100, .names = "{col}"))

missing_counts_long <- pivot_longer(missing_counts, cols = -starts_with("SCHOOL"), names_to = "Grades", values_to = "MissingCountPercent")

custom_grades <- c("PK","KG","G01","G02","G03","G04","G05","G06","G07","G08","G09","G10","G11","G12","G13","UG","AE")

custom_SCHOOL_LEVEL <- c("Prekindergarten","Elementary","Middle","Secondary","High","Ungraded","Adult Education","Not Applicable","Other")

missing_counts_long$Grades <- factor(missing_counts_long$Grades, levels = custom_grades)
missing_counts_long$SCHOOL_LEVEL <- factor(missing_counts_long$SCHOOL_LEVEL, levels = custom_SCHOOL_LEVEL)

# Create a heatmap
ggplot(missing_counts_long, aes(x = SCHOOL_LEVEL, y = Grades, fill = MissingCountPercent))+
  geom_tile() +
  scale_fill_gradient() +
  labs(title = "Heatmap of Missing Values per Columns per Category",
       x = "Category",
       y = "Columns") +
  theme_minimal()+
  theme(axis.text.x = element_text(angle = 90))

```

